I"√<p>I had a look at Uniswap‚Äôs upcoming V3 protocol <a href="https://uniswap.org/blog/uniswap-v3/">overview</a> and 
<a href="https://uniswap.org/whitepaper-v3.pdf">white paper</a>.  There are some substantial improvements above the 
current V2, such as:</p>

<ul>
  <li>ability to offer <strong>‚Äúconcentrated‚Äù liquidity</strong> (we‚Äôll discuss this below)</li>
  <li>ability to introduce pools with varying fee structure</li>
  <li>advances in oracle efficiency and new oracle types</li>
  <li>..</li>
</ul>

<p>For a market maker, the most important of these is the ability to ‚Äúconcentrated‚Äù liquidity.  What does this 
mean?  In V2, one‚Äôs <strong>liquidity was uniformly distributed across all price levels</strong> up to infinity.  In limit-order book
terms, this would be equivalent to offering 1/k coins at each price level (given a maximum of K price levels).
This is <strong>very capital inefficient</strong> as most trading occurs near the prevailing market price.</p>

<p>Here is a diagram from the whitepaper illustrating the liquidity allocation of V2 versus possible distributions of
liquidity in the uniswap V3 pool:</p>

<p><img src="/assets/2021-04-12/concentration.png" width="800" height="350" /></p>

<p>In V3, through the use of range position contracts, one can effect any distribution of liquidity desired.</p>

<h2 id="problems">Problems</h2>
<p>Being able to center liquidity around the mid price (or whatever price is advantageous for inventory) is an
indispensable tool for market makers (and yield farmers for that matter).   However as nice as this seems on the
surface, has some significant issues:</p>

<ul>
  <li>transactions in the ethereum blockchain take 10 - 20 minutes to transact</li>
  <li>gas fees are expensive and progressing higher due to the large # of ERC tokens on Ethereum</li>
</ul>

<p>A traditional market maker will adjust orders (liquidity positions) at high frequency to remain competitive and keep
liquidity near the prevailing market price.  With a transaction overhead measured in 10 - 20 minutes, would require
the market maker to spread liquidity across a wider price range in order to participate in the market, diluting 
capital efficiency while also incuring more risk.</p>

<p>The second issue relates to cost.  Centralized exchange, both traditional and crypto, charge no fees for order
placement.  The gas fees inherent in updating the liquidity position range would tend to be prohibitive if run
in a more traditional manner.</p>

<h2 id="a-solution-pegged-liquidity-contract">A Solution: Pegged Liquidity Contract</h2>
<p>Uniswap should introduce a <strong>Pegged Liquidity</strong> order (contract).  The contract would indicate the following:</p>

<ul>
  <li>supply K coins total</li>
  <li>allocate K coins according to some distribution <strong>relative to the prevailing price</strong></li>
  <li>the distribution is expressed as:
    <ul>
      <li>x coins at level price +/- offset1</li>
      <li>y coins at level price +/- offset2</li>
      <li>‚Ä¶</li>
    </ul>
  </li>
  <li>put a limit on the lowest price willing to offer on
    <ul>
      <li>this avoids following the price in a flash crash or just some level below which the market maker considers
uneconomical</li>
    </ul>
  </li>
</ul>

<p>The contract solves much of the liquidity concentration problem, in that one‚Äôs liquidity can track the price and be
more active in the market.</p>

<h2 id="future-of-uniswap">Future of Uniswap</h2>
<p>Uniswap‚Äôs achilles heel is that it is based on Ethereum.  This has served it well until recently as many of the
coins traded on Uniswap are ERC-20 token, avoiding the need for Ethereum based proxy coins.  However, Ethereum has
some substantial problems for a DEX:</p>

<ul>
  <li>non-deterministic transactions (required K blocks to verify transaction, much like bitcoin)
    <ul>
      <li>hence ultra-high latency</li>
    </ul>
  </li>
  <li>scalability concerns (perhaps mitigated with side-chains)
    <ul>
      <li>however side-chains are not the most elegant solution and may present new attack vectors</li>
    </ul>
  </li>
  <li>high costs (gas fees)</li>
</ul>

<p>The future for DEFI / DEX‚Äôs is likely to be on one of the newer blockchains, ones that:</p>

<ul>
  <li>provide atomic transactions (ideally)</li>
  <li>higher scalability</li>
  <li>lower transaction costs</li>
  <li>interop with other chains</li>
</ul>

<p>In this regard, <strong>Cosmos</strong> looks quite attractive.  Ethereum is moving fast to innovate however.</p>

:ET